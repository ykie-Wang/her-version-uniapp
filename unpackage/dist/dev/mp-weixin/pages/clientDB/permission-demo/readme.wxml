<view class="page data-v-44bded3a"><alert-code class="r data-v-44bded3a" u-r="alertCode" u-i="44bded3a-0" bind:__l="__l"></alert-code><uni-notice-bar wx:if="{{b}}" class="data-v-44bded3a" u-i="44bded3a-1" bind:__l="__l" u-p="{{b}}"></uni-notice-bar><view class="uni-title tip data-v-44bded3a"> 一、示例简介 <text class="data-v-44bded3a">\n 演示了： 1.用户可以编辑自己的个人资料。 2.审核员，审核资料的username字段。 3.审核期间用户不能修改username字段。 4.未登陆的游客看不到用户的phone字段 \n \n</text> 二、需要的资源，schema路径: <text class="data-v-44bded3a">\n uniCloud/database/permission-test.schema.json \n \n</text> 三、数据的介绍，表字段: <text class="data-v-44bded3a">\n username(姓名), state(审核状态), nickname(昵称), phone(手机号码)</text></view><button class="data-v-44bded3a" bindtap="{{c}}" plain type="primary">查看示例</button><view class="tips data-v-44bded3a"><text class="data-v-44bded3a">DB Schema的permission规则，分为两部分，一边是对操作数据的指定，一边是对角色的指定，规则中对两者进行关联，匹配则校验通过。</text></view><page-head wx:if="{{d}}" class="data-v-44bded3a" u-i="44bded3a-2" bind:__l="__l" u-p="{{d}}"></page-head><uni-section wx:if="{{e}}" class="data-v-44bded3a" u-i="44bded3a-3" bind:__l="__l" u-p="{{e}}"></uni-section><view class="uni-title pl10 data-v-44bded3a"> 配置规则： <scroll-view scroll-x class="code-box data-v-44bded3a"><show-code wx:if="{{f}}" class="data-v-44bded3a" u-i="44bded3a-4" bind:__l="__l" u-p="{{f}}"></show-code></scroll-view><text class="data-v-44bded3a">含义解释：允许任何账户读取本表</text></view><button class="data-v-44bded3a" bindtap="{{g}}" plain type="primary">读取表全部数据</button><view class="uni-title pl10 data-v-44bded3a"> 配置规则： <scroll-view scroll-x class="code-box data-v-44bded3a"><show-code wx:if="{{h}}" class="data-v-44bded3a" u-i="44bded3a-5" bind:__l="__l" u-p="{{h}}"></show-code></scroll-view><text class="data-v-44bded3a">含义解释： 禁止任何账户执行删除表中的记录操作</text><text class="data-v-44bded3a">\n 但管理员账号不受schema限制，可在底部工具条切换成管理员角色体验</text></view><button class="data-v-44bded3a" bindtap="{{i}}" plain type="primary">删除全部记录数据</button><uni-section wx:if="{{j}}" class="data-v-44bded3a" u-i="44bded3a-6" bind:__l="__l" u-p="{{j}}"></uni-section><view class="uni-title pl10 data-v-44bded3a"> 配置规则： <scroll-view scroll-x class="code-box data-v-44bded3a"><show-code wx:if="{{k}}" class="data-v-44bded3a" u-i="44bded3a-7" bind:__l="__l" u-p="{{k}}"></show-code></scroll-view><text class="data-v-44bded3a">含义解释：表示仅已登陆后的用户才能执行创建操作</text></view><button class="data-v-44bded3a" bindtap="{{l}}" plain type="primary">创建一条数据</button><uni-section wx:if="{{m}}" class="data-v-44bded3a" u-i="44bded3a-8" bind:__l="__l" u-p="{{m}}"></uni-section><view class="uni-title pl10 uni-common-mt data-v-44bded3a"> 配置规则： <scroll-view scroll-x class="code-box data-v-44bded3a"><show-code wx:if="{{n}}" class="data-v-44bded3a" u-i="44bded3a-9" bind:__l="__l" u-p="{{n}}"></show-code></scroll-view><text class="data-v-44bded3a">含义解释：\n 1.数据创建者 \n 2.角色为审核员 \n 3.拥有编辑权限; \n 三种情况，拥有字段更新权限 </text></view><button class="data-v-44bded3a" bindtap="{{o}}" plain type="primary"><text class="data-v-44bded3a">更新nickname="新昵称"\n（仅当前用户为创建者的数据）</text></button><button class="data-v-44bded3a" bindtap="{{p}}" plain type="primary"><text class="data-v-44bded3a">更新nickname="新昵称"\n（表中全部数据）</text></button><page-head wx:if="{{q}}" class="data-v-44bded3a" u-i="44bded3a-10" bind:__l="__l" u-p="{{q}}"></page-head><uni-section wx:if="{{r}}" class="data-v-44bded3a" u-i="44bded3a-11" bind:__l="__l" u-p="{{r}}"></uni-section><view class="uni-title pl10 uni-common-mt data-v-44bded3a"> 配置规则： <scroll-view scroll-x class="code-box data-v-44bded3a"><show-code wx:if="{{s}}" class="data-v-44bded3a" u-i="44bded3a-12" bind:__l="__l" u-p="{{s}}"></show-code></scroll-view></view><button class="data-v-44bded3a" bindtap="{{t}}" plain type="primary"><text class="data-v-44bded3a">更新 state = 1</text></button><view class="uni-title pl10 uni-common-mt data-v-44bded3a"><text class="data-v-44bded3a">含义解释：限角色为审核员才能更新，字段state</text></view><uni-section wx:if="{{v}}" class="data-v-44bded3a" u-i="44bded3a-13" bind:__l="__l" u-p="{{v}}"></uni-section><view class="uni-title pl10 uni-common-mt data-v-44bded3a"><view class="data-v-44bded3a">配置规则：</view><scroll-view scroll-x class="code-box data-v-44bded3a"><show-code wx:if="{{w}}" class="data-v-44bded3a" u-i="44bded3a-14" bind:__l="__l" u-p="{{w}}"></show-code></scroll-view><text class="data-v-44bded3a">含义解释：表示执行该操作需要满足，update的表级权限控制外，还需要满足正在被操作的记录的字段state!=0</text></view><button class="data-v-44bded3a" bindtap="{{x}}" plain type="primary"><text class="data-v-44bded3a">更新 username:'新姓名' \n(表中全部数据)</text></button><button class="data-v-44bded3a" bindtap="{{y}}" plain type="primary"><text class="data-v-44bded3a">更新 username:'新姓名' \n(仅当前角色为创建者的数据)</text></button><uni-section wx:if="{{z}}" class="data-v-44bded3a" u-i="44bded3a-15" bind:__l="__l" u-p="{{z}}"></uni-section><view class="uni-title pl10 uni-common-mt data-v-44bded3a"> 配置规则：<scroll-view scroll-x class="code-box data-v-44bded3a"><show-code wx:if="{{A}}" class="data-v-44bded3a" u-i="44bded3a-16" bind:__l="__l" u-p="{{A}}"></show-code></scroll-view><text class="data-v-44bded3a">含义解释：综合表级任何用户可读的条件下，新增了未登录游客不能读取phone字段</text></view><button class="data-v-44bded3a" bindtap="{{B}}" plain type="primary">读不带phone字段的数据</button><button class="data-v-44bded3a" bindtap="{{C}}" plain type="primary">读带phone字段的数据</button><set-permission class="r data-v-44bded3a" u-r="set-permission" bindchange="{{E}}" u-i="44bded3a-17" bind:__l="__l"></set-permission></view>